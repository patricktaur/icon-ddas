<div class="row">
	<div class="col-lg-12">
		<div class="well">
			<h3 class="no-margin-top">Audit by {{audit.Auditor}} {{audit.CompletedOn | date: 'dd MMM yyyy'}} </h3>
			<label for="auditStatus">Status:</label>
			{{audit.AuditStatus}}
		</div>
	</div>

	<div class="col-lg-12">
        <div class="well">
			<div class="row">
				<div class="col-md-6">
					<div class="form-group">
						<label for="PrincipalInvestigator">Principal Investigator:</label>
						{{complianceForm.ProjectNumber}}
					</div>
				</div>
				<div class="form-group">
					<label for="Institute">Institute:</label>
					{{complianceForm.Institute}}
				</div>
				<div class="col-md-6">
					<div class="form-group">
						<label for="SponsorProtocolNumber">Sponsor Protocol Number:</label>
						{{complianceForm.SponsorProtocolNumber}}
					</div>
				</div>
				<div class="form-group">
					<label for="Address">Address:</label>
					{{complianceForm.Address}}
				</div>
			</div>
			
			<h4>Investigators:</h4>
			<div class="well">
				<table class="table table-bordered table-hover table-striped">
					<thead>
						<tr>
							<th class="col-md-2 text-left">Role</th>
							<th class="col-md-3 text-left">Investigator Name</th>
							<th class="col-md-2 text-left">Medical License Number</th>
							<th class="col-md-3 text-left">Investigator Name (All Combinations Searched)</th>
						</tr>
					</thead>
					<tbody>
						<tr class="active" *ngFor="let item of Investigators">
							<td class="text-left">
								{{item.Role}}
							</td>
							<td class="text-left">
								{{item.Name}}
							</td>
							<td class="text-left">
								{{item.MedicalLicenseNumber}}
							</td>
							<td class="text-left">
								{{item.FirstName}}
							</td>																	
						</tr>
					</tbody>
				</table>
			</div>

			<h4>Site Sources:</h4>
			<div class="well">
				<table class="table table-bordered table-hover table-striped">
					<thead>
						<tr>
							<th class="col-md-1 text-left">Source #</th>
							<th class="col-md-4 text-left">Source Name</th>
							<th class="col-md-3 text-center">Source Date</th>
							<th class="col-md-3 text-left">Weblink</th>
							<th class="col-md-1 text-left">Issues Identified</th>
						</tr>
					</thead>
					<tbody>
						<tr class="active" *ngFor="let item of SiteSources">
							<td class="text-left">
								{{item.Id}}
							</td>
							<td class="text-left">
								{{item.SiteName}}
							</td>
							<td class="text-left">
								{{item.SiteSourceUpdatedOn | date: 'dd MMM yyyy'}}
							</td>
							<td class="text-left">
								{{item.SiteUrl}}
							</td>
							<td class="text-left">
								{{item.IssuesIdentified | boolToYesNo }}
							</td>
						</tr>
					</tbody>
				</table>
			</div>
			
			<h4>Additional Site Sources:</h4>
			<div class="well">
				<table class="table table-bordered table-hover table-striped">
					<thead>
						<tr>
							<th class="col-md-1 text-left">Source #</th>
							<th class="col-md-4 text-left">Source Name</th>
							<th class="col-md-3 text-center">Source Date</th>
							<th class="col-md-4 text-left">Weblink</th>
							<th class="col-md-1 text-left">Issues Identified</th>
						</tr>
					</thead>
					<tbody>
						<tr class="active" *ngFor="let item of AdditionalSiteSources">
							<td class="text-left">
								{{item.Id}}
							</td>
							<td class="text-left">
								{{item.SiteName}}
							</td>
							<td class="text-left">
								{{item.SiteSourceUpdatedOn | date: 'dd MMM yyyy'}}
							</td>
							<td class="text-left">
								{{item.SiteUrl}}
							</td>
							<td class="text-left">
								{{item.IssuesIdentified | boolToYesNo }}
							</td>
						</tr>
					</tbody>
				</table>
			</div>			

			<h4>Findings:</h4>
			<div class="well">
				<table class="table table-bordered table-hover table-striped">
					<thead>
						<tr>
							<th class="col-md-1 text-left">Source #</th>
							<th class="col-md-3 text-left">Investigator Name</th>
							<th class="col-md-3 text-center">Date Of Inspection/Action</th>
							<th class="col-md-4 text-center">Description Of Findings</th>
						</tr>
					</thead>
					<tbody>
						<tr class="active" *ngFor="let item of Findings">
							<td class="text-left">
								{{item.SiteSourceId}}
							</td>
							<td class="text-left">
								{{item.InvestigatorName}}
							</td>
							<td class="text-left">
								{{item.DateOfInspection | date: 'dd MMM yyyy'}}
							</td>
							<td class="text-left">
								{{item.Observation}}
							</td>
						</tr>
					</tbody>
				</table>
			</div>			
		</div>
		<div class="well">
            <div class="row">
                <div class="col-md-6">
                    <div class="form-group">
                        <label for="Status" *ngIf="!isSubmitted">Audit Response:</label>
                        <select class="form-control" [(ngModel)]="siteId" *ngIf="!isSubmitted">
                             <option *ngFor="let item of audit.Observations" [value]="item.SiteId">
								 {{item.SiteId}} {{item.SiteShortName}}
								</option>
                        </select>
                    </div>
                    <label for="Comments" *ngIf="!isSubmitted">Observation:</label>
                    <textarea name="Comments" class="form-control" id="Observation" rows="4" cols="20" placeholder="observations"
                    [(ngModel)]="observation" *ngIf="!isSubmitted"></textarea>
                </div>
                <div class="col-md-6">
                </div>
			</div>
			<button type="button" class="btn btn-primary" (click)="acceptObservation()" *ngIf="!isSubmitted">Accepted</button>
			<button type="button" class="btn btn-primary" (click)="rejectObservation()" *ngIf="!isSubmitted">Rejected</button>

			<table class="table table-bordered table-hover table-striped">
				<thead>
					<tr>
						<th class="col-md-1 text-left">Site # </th>
						<th class="col-md-3 text-left">Observations</th>
						<th class="col-md-2 text-left">Status</th>
						<th class="col-md-2 text-left">Actions</th>
					</tr>
				</thead>
				<tbody>
					<tr class="active" *ngFor="let item of Observations">
						<td class="text-left">
							{{item.SiteId}}
						</td>
						<td class="text-center">
							{{item.Comments}}
						</td>
						<td class="text-center">
							{{item.Status}}
						</td>
						<td>
							<button type="button" class="btn btn-sm btn-primary" (click)="deleteObservation(item.SiteId)" title="delete observation" *ngIf="!isSubmitted">
                            	<span class="glyphicon glyphicon-remove"></span>
                        	</button>
						</td>
					</tr>
				</tbody>
			</table>
            <pagination-controls (pageChange)="pageNumber = $event"></pagination-controls>
            <button type="button" class="btn btn-primary" (click)="save(false)" *ngIf="!isSubmitted" >Save</button>
            <button type="button" class="btn btn-primary" (click)="submit(true)" *ngIf="!isSubmitted">Submit</button>
		</div>
	</div>
</div>